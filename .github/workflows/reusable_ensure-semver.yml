---
name: Build & Push Image to GHCR
on:
  workflow_call:
    inputs:
      semver:
        required: true
        type: string
jobs:
  ensure-semver:
    runs-on: ubuntu-latest
    steps:
      - name: Check Tag
        id: check-tag
        run: |-
          if [[ '${{ github.ref_name }}' =~ ^[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
            echo ::set-output name=match::true
          fi
      - name: Report SemVer Check
        if: steps.check-tag.outputs.match != 'true'
        run: echo "Release version must follow semantic naming (e.g. 1.0.2)"; exit 1